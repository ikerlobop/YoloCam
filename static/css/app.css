/* ========== PALETA & BASE ========== */
:root{
  --bg: #0e1116;            /* fondo app */
  --bg-soft: #12161d;       /* contenedores */
  --panel: #141922;         /* paneles/tiles */
  --panel-2: #0f141a;       /* sidebar/photo */
  --text: #e7ebf3;          /* texto principal */
  --muted: #a1adbf;         /* texto secundario */
  --border: #1f2430;        /* bordes discretos */
  --accent: #2563eb;        /* primario corporativo (azul) */
  --accent-600:#1e4fd0;
  --accent-700:#1a45b9;
  --danger: #d92d20;        /* rojo discreto */
  --warn: #f59e0b;          /* ámbar discreto */
  --ok: #16a34a;            /* verde discreto */
  --bg-1:#0e1116;   /* base */
  --bg-2:#0b0f14;   /* tono más oscuro */
  --bg-3:#131826;   /* leve azul */
}



*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%}
body{
  font-family: Segoe UI,system-ui,-apple-system,Roboto,Ubuntu,Cantarell,Arial;
  color: var(--text);
  overflow: hidden;
  background:
    radial-gradient(1200px 800px at 10% 0%, rgba(37,99,235,.10), transparent 55%),
    radial-gradient(1000px 700px at 90% 100%, rgba(37,99,235,.08), transparent 50%),
    linear-gradient(135deg, var(--bg-1) 0%, var(--bg-2) 45%, var(--bg-3) 100%);
}

/* ========== SIDEBAR ========== */
.sidebar{
  position:fixed;left:0;top:0;
  width:320px;height:100vh;
  background: var(--panel-2);
  border-right: 1px solid var(--border);
  z-index:100;overflow-y:auto;
}

.sidebar-header{
  padding: 16px 18px;
  border-bottom:1px solid var(--border);
  background: var(--panel-2);
}
.system-title{font-size:18px;font-weight:800;margin-bottom:4px}
.system-subtitle{font-size:12px;color:var(--muted)}

.project-section,.layer-section,.position-section{
  padding: 18px; border-bottom:1px solid var(--border);
}
.section-label{
  font-size:11px;color:var(--muted);font-weight:700;
  text-transform:uppercase;letter-spacing:.6px;margin-bottom:8px;
}
.project-name{font-size:16px;font-weight:700;margin-bottom:10px}

.info-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.info-item{
  background: var(--bg);
  padding:8px 10px;border-radius:6px;
  border:1px solid var(--border);
}
.info-label{font-size:10px;color:var(--muted);text-transform:uppercase;margin-bottom:2px}
.info-value{font-size:13px;font-weight:600}

/* Capa actual */
.current-layer-display{
  background: var(--panel);
  border:1px solid var(--border);
  padding:16px;border-radius:8px;text-align:center;margin-bottom:14px;
}
.layer-number{font-size:28px;font-weight:800;line-height:1;color:var(--text)}
.layer-total{font-size:12px;color:var(--muted);margin-top:6px}

/* Posición ATL */
.position-display{
  background: var(--panel);
  border:1px solid var(--border);
  border-radius:10px;padding:16px;margin-bottom:14px;
}
.position-title{
  text-align:center;font-size:14px;font-weight:700;color:var(--muted);
  text-transform:uppercase;letter-spacing:.8px;margin-bottom:12px;
}
.position-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.position-item{
  background: var(--bg);
  border:1px solid var(--border);border-radius:8px;
  padding:12px;text-align:center;
}
.position-axis{font-size:14px;font-weight:700;color:var(--muted);margin-bottom:6px}
.position-value{font-size:20px;font-weight:700;font-family: ui-monospace, SFMono-Regular, Menlo, Consolas}
.position-unit{font-size:11px;color:var(--muted);margin-top:3px}
.position-status{
  margin-top:12px;text-align:center;font-size:12px;color:var(--muted);
  padding:8px;background: var(--bg);border:1px solid var(--border);border-radius:6px;
  display:flex;align-items:center;justify-content:center;gap:8px
}
.status-dot-position{width:6px;height:6px;background:var(--ok);border-radius:50%}

/* ========== LAYOUT PRINCIPAL ========== */
.main-area{
  margin-left:320px;height:100vh;
  display:grid;grid-template-columns:1fr 320px;grid-template-rows:auto 1fr auto;
}
.top-bar{
  grid-column:1/-1;background: var(--panel);
  padding:12px 20px;display:flex;gap:16px;align-items:center;justify-content:space-between;
  border-bottom:1px solid var(--border);
}

.controls-section{display:flex;align-items:center;gap:12px;margin-left:auto}
.time-and-logout{display:flex;align-items:center;gap:10px}
.time-display{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas;font-size:16px;font-weight:700;color:var(--muted)}
.logout-btn{
  border:1px solid var(--border);background: var(--panel-2);
  color: var(--text);font-weight:600;padding:8px 12px;border-radius:6px;cursor:pointer;
  transition: background .15s ease,border-color .15s ease;
}
.logout-btn:hover{background:#161c26;border-color:#2a3242}

/* ========== CONTENIDO PRINCIPAL ========== */
.main-content{
  position:relative;margin:16px 0 0 16px;border-radius:10px;overflow:hidden;
  background: var(--panel);border:1px solid var(--border);display:flex;flex-direction:column;
}
.video-header{
  background: rgba(0,0,0,.25);
  padding:10px 14px;display:flex;justify-content:space-between;align-items:center;
  border-bottom:1px solid var(--border);
}
.video-title{font-size:13px;font-weight:700;color:var(--muted)}
.video-stats{font-size:12px;color:var(--muted)}

/* ========== BIBLIOTECA ========== */
.photo-library{
  background: var(--panel-2);
  border-left:1px solid var(--border);
  display:flex;flex-direction:column;margin:16px 16px 0 16px;border-radius:10px 0 0 0;
}
.library-header{
  padding:12px;color:var(--text);font-weight:700;font-size:13px;text-align:center;text-transform:uppercase;
  border-bottom:1px solid var(--border);background: var(--panel-2);
}
.photos-container{flex:1;overflow-y:auto;padding:12px;max-height:calc(100vh - 230px)}

/* ========== GRID 2×5 ========== */
.grid-wrap{position:relative;width:min(1600px,98%);margin:12px auto}
.gridTitle{font-size:12px;letter-spacing:.3px;color:var(--muted);margin:6px 0 6px 6px}
.grid{
  position:relative;display:grid;grid-template-columns:repeat(5,1fr);
  grid-auto-rows:1fr;gap:12px;
}
.grid-row-2{direction:rtl;display:contents}
.cell{
  position:relative;height:150px;background: var(--bg);
  border:1px solid var(--border);border-radius:10px;overflow:hidden;
  display:grid;place-items:center;
}
.cell img{width:100%;height:100%;object-fit:contain;display:block;background:#000}
.slot{opacity:.6;font-size:.9rem;color:var(--muted)}

/* ========== THUMBS (biblioteca y dataset) ========== */
.thumb-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.thumb{
  width:100%;aspect-ratio:16/9;object-fit:contain;background:#000;
  border-radius:8px;border:1px solid var(--border);cursor:pointer;transition:transform .15s ease, box-shadow .15s ease;
}
.thumb:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,.25)}

.bottom-status{
  grid-column:1/-1;background:var(--bg);padding:10px 20px;border-top:1px solid var(--border);
  display:flex;justify-content:space-between;align-items:center;color:var(--muted);font-size:12px;
}

/* ========== OPERARIO & ACCIONES ========== */
.operator-info{display:flex;align-items:center;gap:16px}
.operator-selector{
  display:flex;align-items:center;gap:12px;padding:8px 12px;border-radius:20px;
  background: var(--bg);border:1px solid var(--border);
}
.operator-avatar{
  width:40px;height:40px;background: var(--accent);color:#fff;border-radius:50%;
  display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px;
}
.operator-name{font-size:15px;font-weight:600}
.operator-role{font-size:12px;color:var(--muted)}
.action-buttons{display:flex;gap:10px;margin-left:8px}

/* ========== BOTONES ========== */
.btn-small{
  padding:8px 14px;border:1px solid var(--accent-700);border-radius:6px;
  background: var(--accent);color:#fff;font-weight:700;font-size:12px;cursor:pointer;
  display:inline-flex;align-items:center;gap:6px;text-decoration:none;
  transition: background .15s ease, border-color .15s ease, transform .05s ease;
}
.btn-small:hover{background:var(--accent-600);border-color:var(--accent-600)}
.btn-small:active{transform:scale(0.98)}
.btn-small:disabled{opacity:.6;cursor:not-allowed}

/* variantes (por si las necesitas) */
.btn-secondary{background:#1c2330;border-color:#283044}
.btn-secondary:hover{background:#21293a}
.btn-warn{background:var(--warn);border-color:#de8d05;color:#1b1306}
.btn-danger{background:var(--danger);border-color:#b42318}

/* ========== TRAINING PANE & CANVAS ========== */
.training-pane{
  background: var(--panel-2);
  border-top:1px solid var(--border);
  padding:12px;display:flex;flex-direction:column;gap:12px;
}
.training-pane .train-toolbar .row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.training-pane .train-toolbar label{font-size:12px;color:var(--muted)}
.training-pane .train-toolbar .spacer{flex:1}
#classInput{
  padding:6px 10px;background:#0c1118;color:var(--text);
  border:1px solid var(--border);border-radius:6px;min-width:220px;
}
.train-canvas-wrap{
  display:flex;align-items:center;justify-content:center;background:#0b0f15;
  border:1px solid var(--border);border-radius:8px;padding:8px;
}
#trainCanvas{background:#000;border:1px solid #2b3344;cursor:none}
.hud{margin-left:auto;font-size:12px;color:var(--muted)}

/* ========== MODAL / LIGHTBOX ========== */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;z-index:999}
.modal.hidden{display:none}
.modal-inner{position:relative}
#lightboxOverlay{position:absolute;left:0;top:0;z-index:2}
#lightboxImg{display:block;max-width:100%;max-height:90vh;object-fit:contain;z-index:1}
.modal-inner img{
  max-width:100%;max-height:90vh;border-radius:8px;border:1px solid var(--border);display:block
}
.modal-close{
  position:absolute;top:-12px;right:-12px;background:var(--panel);
  border:1px solid var(--border);border-radius:999px;width:34px;height:34px;color:var(--text);
  font-weight:800;font-size:18px;cursor:pointer;
}

/* ========== OVERLAYS (scan/bbox) ========== */
.scan-overlay{
  position:absolute;left:0;top:0;pointer-events:none;z-index:50;
  transition: transform .3s ease, width .2s ease, height .2s ease, opacity .2s ease;
  opacity:.95;filter: drop-shadow(0 0 4px rgba(37,99,235,.35));  /* acento azul sutil */
}
.scan-overlay.hidden{opacity:0;visibility:hidden}
.scan-center-h,.scan-center-v{position:absolute;left:0;top:0;right:0;bottom:0}
.scan-center-h::before,.scan-center-v::before{
  content:"";position:absolute;background: var(--accent);
  box-shadow:0 0 6px rgba(37,99,235,.35);
}
.scan-center-h::before{left:0;right:0;top:50%;height:1px;transform:translateY(-.5px)}
.scan-center-v::before{top:0;bottom:0;left:50%;width:1px;transform:translateX(-.5px)}
.scan-sweep-h,.scan-sweep-v{position:absolute;inset:0;overflow:hidden}
.scan-sweep-h::after,.scan-sweep-v::after{
  content:"";position:absolute;opacity:.5;background: linear-gradient(90deg, rgba(37,99,235,0) 0%, rgba(37,99,235,.7) 50%, rgba(37,99,235,0) 100%);
}
.scan-sweep-h::after{top:49%;height:2px;width:120%;animation:sweepX 2.2s linear infinite}
.scan-sweep-v::after{
  left:49%;width:2px;height:120%;
  background: linear-gradient(180deg, rgba(37,99,235,0) 0%, rgba(37,99,235,.7) 50%, rgba(37,99,235,0) 100%);
  animation:sweepY 2.6s linear infinite;
}
@keyframes sweepX{0%{transform:translateX(-10%)}50%{transform:translateX(-5%)}100%{transform:translateX(110%)}}
@keyframes sweepY{0%{transform:translateY(-10%)}50%{transform:translateY(-5%)}100%{transform:translateY(110%)}}

.scan-border{position:absolute;inset:0;border:1px dashed rgba(37,99,235,.35);border-radius:10px}

.bbox-layer{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:60}
.bbox{position:absolute;border:2px solid var(--accent);border-radius:6px;box-shadow:0 0 4px rgba(37,99,235,.35)}
.bbox-label{
  position:absolute;top:-18px;left:0;background: var(--accent);
  color:#fff;font-weight:700;font-size:10px;padding:2px 6px;border-radius:6px;
}

/* Marcador centro (lightbox/thumbs) */
.center-marker{
  position:absolute;width:14px;height:14px;border:2px solid #93c5fd;border-radius:50%;
  box-shadow:0 0 6px rgba(147,197,253,.6);pointer-events:none;
}
.center-marker::before,.center-marker::after{content:"";position:absolute;left:50%;top:50%;background:#93c5fd;transform:translate(-50%,-50%)}
.center-marker::before{width:2px;height:16px}
.center-marker::after{width:16px;height:2px}
.center-label{
  position:absolute;background:rgba(10,14,22,.8);color:#cbd5e1;font-size:11px;font-weight:700;
  padding:4px 6px;border:1px solid var(--border);border-radius:6px;pointer-events:none;white-space:nowrap;backdrop-filter: blur(2px);
}

.hidden{display:none!important}

/* ========== SCROLLBAR ========== */
::-webkit-scrollbar{width:10px;height:10px}
::-webkit-scrollbar-track{background:#0c1016}
::-webkit-scrollbar-thumb{background:#1c2330;border-radius:6px}
::-webkit-scrollbar-thumb:hover{background:#263044}


.image-preview {
  display: inline-flex;
  margin-left: 10px;
  align-items: center;
}

.image-preview img {
  max-width: 200px;     /* límite horizontal */
  max-height: 120px;     /* límite vertical */
  width: auto;
  height: auto;
  object-fit: contain;   /* mantiene proporciones */
  border: 1px solid var(--border);
  border-radius: 6px;
  background: #000;      /* fondo negro si la imagen no llena */
  cursor: zoom-in;
  display: none;         /* oculto si no hay imagen */
}

.image-preview img.show {
  display: block;
}

/* (ya tienes estilos .modal / .modal-inner / .modal-close en tu CSS) */
#imgFull {
  max-width: 90vw;
  max-height: 90vh;
  object-fit: contain;
  display: block;
}

/* ===== FILMSTRIP (responsive y sin ocupar todo el ancho) ===== */
.filmstrip{
  display:flex; align-items:center; gap:8px;
  background: var(--panel); border:1px solid var(--border);
  border-radius:8px; padding:8px;

  /* Clave: no expandirse a todo el ancho */
  flex: 0 1 640px;       /* base 640px, puede encoger, no crecer infinito */
  width: auto;
  max-width: 100%;
}

.strip-view{ position:relative; overflow:hidden; flex:1; min-width: 0; }
.strip-track{ display:flex; gap:8px; overflow-x:auto; scroll-behavior:smooth; padding-bottom:6px; }
.strip-thumb{ position:relative; flex:0 0 auto; width:110px; height:70px;
  border:1px solid var(--border); border-radius:6px; background:#000; cursor:pointer;
  display:grid; place-items:center;
}
.strip-thumb img{ max-width:100%; max-height:100%; object-fit:contain; display:block; }
.strip-thumb.active{ outline:2px solid var(--accent); box-shadow:0 0 0 2px rgba(37,99,235,.35) inset; }
.strip-thumb .name{
  position:absolute; left:6px; right:6px; bottom:6px;
  background:rgba(0,0,0,.55); color:#cbd5e1; font-size:10px; padding:2px 4px; border-radius:4px;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.strip-btn{
  min-width:34px; height:34px; border-radius:8px; cursor:pointer;
  border:1px solid var(--border); background: var(--panel-2); color:var(--text);
  font-weight:800; font-size:14px;
}
.strip-btn:hover{ background:#161c26; }

/* ——— Breakpoints ——— */

/* Pantallas medianas: quepa más cómodo dentro de la toolbar */
@media (max-width: 1280px){
  .filmstrip{ flex: 0 1 520px; }
  .strip-thumb{ width:96px; height:60px; }
}

/* Pantallas estrechas: que la filmstrip “baje” a su propia línea sin llenar todo */
@media (max-width: 960px){
  /* Hace que la filmstrip use toda la fila, pero respetando su contenido */
  .filmstrip{ flex: 1 1 100%; }
}

/* Muy estrecho: miniaturas compactas y escondemos nombre si hace falta */
@media (max-width: 640px){
  .strip-thumb{ width:80px; height:52px; }
  .strip-thumb .name{ display:none; }
}

/* ocultar scrollbar horizontal en algunos navegadores (opcional) */
.strip-track::-webkit-scrollbar{ height:8px }
.strip-track::-webkit-scrollbar-thumb{ background:#1c2330; border-radius:6px }

/* === Layout columna estable, sin desbordes verticales === */
.train-body{
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 12px;
  min-height: 0;           /* IMPORTANTE: permite que los hijos con flex:1 no desborden */
}

/* La toolbar ocupa su altura natural */
.train-toolbar{ flex: 0 0 auto; }

/* El wrap del canvas ocupa TODO el espacio restante sin salirse */
.train-canvas-wrap{
  flex: 1 1 auto;          /* crece y encoge dentro de .train-body */
  min-height: 0;           /* evita overflow por contenidos internos */
  display: flex;
  align-items: center;
  justify-content: center;
  background:#111;
  border:1px solid #2a2a35;
  border-radius:8px;
  padding:8px;
  margin-bottom: 24px;     /* margen inferior que pedías */
  overflow: hidden;        /* si algo intenta salirse, se recorta */
}

/* Canvas responsive: cabe SIEMPRE dentro del wrap */
#trainCanvas{
  /* El lienzo real sigue siendo 960x640 (atributos HTML), 
     pero aquí lo escalamos visualmente sin deformarlo */
  max-width: 80%;
  max-height: 80%;
  width: auto;
  height: auto;
  aspect-ratio: 3 / 2;     /* mantiene relación 960x640 */
  background:#000;
  border:1px solid #00ff41;
  cursor: none;
  display: block;
  box-sizing: border-box;
}
